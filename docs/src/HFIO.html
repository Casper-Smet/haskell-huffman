<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : HFIO
Description : Module containing helper functions for encoding and decoding to file
Copyright   : (c) Casper Smet, 2019
License     : BSD3
Maintainer  : casper.smet@student.hu.nl

This module contains helper functions for encoding and decoding to file. Actual writing to file only happens in the application side of this library
This module was created for the Utrecht University of Applied Sciences AI course 'Declarative Programming'

There are a couple of references to \'delimiter1\' and \'delimiter2\'. These are defined as follows:

* delimiter1 = &quot;||\@||&quot;
* delimiter2 = &quot;\/\/#\/\/&quot;

-}</span><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HFIO</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="HFIO.html#keyFromString"><span class="hs-identifier hs-var">keyFromString</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HFIO.html#reshapeCodes"><span class="hs-identifier hs-var">reshapeCodes</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HFIO.html#formatCodes"><span class="hs-identifier hs-var">formatCodes</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HFIO.html#listifyCodes"><span class="hs-identifier hs-var">listifyCodes</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HFIO.html#readCodes"><span class="hs-identifier hs-var">readCodes</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HFIO.html#readCodeString"><span class="hs-identifier hs-var">readCodeString</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Split</span><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">splitOn</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- ####  #######  </span><span>
</span><a name="line-29"></a><span class="hs-comment">--  ##  ##     ## </span><span>
</span><a name="line-30"></a><span class="hs-comment">--  ##  ##     ## </span><span>
</span><a name="line-31"></a><span class="hs-comment">--  ##  ##     ## </span><span>
</span><a name="line-32"></a><span class="hs-comment">--  ##  ##     ## </span><span>
</span><a name="line-33"></a><span class="hs-comment">--  ##  ##     ## </span><span>
</span><a name="line-34"></a><span class="hs-comment">-- ####  ####### </span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- -- TODO: Add comments</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- -- TODO: Add check for in '0,1'</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- | First delimiter used for encoding map \&quot;||\@||\&quot;</span><span>
</span><a name="line-40"></a><a name="delimiter1"><a href="HFIO.html#delimiter1"><span class="hs-identifier">delimiter1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;||@||&quot;</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- | Second delimiter used for encoding map \&quot;\//#\//\&quot;</span><span>
</span><a name="line-42"></a><a name="delimiter2"><a href="HFIO.html#delimiter2"><span class="hs-identifier">delimiter2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;//#//&quot;</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | Takes a string containing \'1\' or \'0\'s, returns list of Int. </span><span>
</span><a name="line-45"></a><span class="hs-identifier">keyFromString</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>       </span><span class="hs-comment">-- ^ String, example: &quot;0101&quot;</span><span>
</span><a name="line-46"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ List of Int, example: [0,1,0,1]</span><span>
</span><a name="line-47"></a><a name="keyFromString"><a href="HFIO.html#keyFromString"><span class="hs-identifier">keyFromString</span></a></a><span> </span><a name="local-6989586621679021151"><a href="#local-6989586621679021151"><span class="hs-identifier">key</span></a></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;01&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679021151"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">read</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022297"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679022297"><a href="#local-6989586621679022297"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679021151"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">]</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;keyFromString; Bad Huffman key&quot;</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- | Reshapes Huffman Map</span><span>
</span><a name="line-52"></a><span class="hs-identifier">reshapeCodes</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- ^ Huffman Map in tuple form, example: [(\'c\', [1,0,1])]</span><span>
</span><a name="line-53"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ Huffman Map in Tuple form, example: [(\'c\', \&quot;101\&quot;)]</span><span>
</span><a name="line-54"></a><a name="reshapeCodes"><a href="HFIO.html#reshapeCodes"><span class="hs-identifier">reshapeCodes</span></a></a><span> </span><a name="local-6989586621679022355"><a href="#local-6989586621679022355"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679022356"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679022356"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679022356"><a href="#local-6989586621679022356"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679022355"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- FIXME: ++ and [c] are slow, very bad, and not good. Figure out an alternative. Individual strings + concat</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- | Takes a list of Huffman Key-Value pairs, turns into String for printing to file. Uses delimiter1 and delimiter2.</span><span>
</span><a name="line-58"></a><span class="hs-identifier">formatCodes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- ^ Huffman Map in tuple form, example: [(\'c\', &quot;101&quot;), (\'d\', &quot;110&quot;)]</span><span>
</span><a name="line-59"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>                   </span><span class="hs-comment">-- ^ Stringified Huffman map for printing to file, example: \&quot;c||\@||101\/\/\#\/\/d||\@||110\&quot;</span><span>
</span><a name="line-60"></a><a name="formatCodes"><a href="HFIO.html#formatCodes"><span class="hs-identifier">formatCodes</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-61"></a><span class="hs-identifier">formatCodes</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-6989586621679023222"><a href="#local-6989586621679023222"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679023223"><a href="#local-6989586621679023223"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023222"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="HFIO.html#delimiter1"><span class="hs-identifier hs-var">delimiter1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679023223"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-62"></a><span class="hs-identifier">formatCodes</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679023224"><a href="#local-6989586621679023224"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679023225"><a href="#local-6989586621679023225"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679023226"><a href="#local-6989586621679023226"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023224"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="HFIO.html#delimiter1"><span class="hs-identifier hs-var">delimiter1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679023225"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="HFIO.html#delimiter2"><span class="hs-identifier hs-var">delimiter2</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="HFIO.html#formatCodes"><span class="hs-identifier hs-var">formatCodes</span></a><span> </span><a href="#local-6989586621679023226"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Inverse of 'formatCodes' using lists instead of tuples</span><span>
</span><a name="line-65"></a><span class="hs-identifier">listifyCodes</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>       </span><span class="hs-comment">-- ^ Stringified Huffman map, example: \&quot;c||\@||101\/\/\#\/\/d||\@||110\&quot;</span><span>
</span><a name="line-66"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ Two dimensional list containing String-code pairs, example: [[\&quot;c\&quot;, \&quot;101\&quot;], [\&quot;d\&quot;, \&quot;110\&quot;]] </span><span>
</span><a name="line-67"></a><a name="listifyCodes"><a href="HFIO.html#listifyCodes"><span class="hs-identifier">listifyCodes</span></a></a><span> </span><a name="local-6989586621679023227"><a href="#local-6989586621679023227"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">splitOn</span><span> </span><a href="HFIO.html#delimiter1"><span class="hs-identifier hs-var">delimiter1</span></a><span> </span><a href="#local-6989586621679023579"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679023579"><a href="#local-6989586621679023579"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">splitOn</span><span> </span><a href="HFIO.html#delimiter2"><span class="hs-identifier hs-var">delimiter2</span></a><span> </span><a href="#local-6989586621679023227"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- | Takes two-dimensional list, returns tuple pair (Huffman Map)</span><span>
</span><a name="line-70"></a><span class="hs-identifier">readCodes</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- ^ Two dimensional list containg String-code pairs, example [[\&quot;c\&quot;, \&quot;101\&quot;], [\&quot;d\&quot;, \&quot;110\&quot;]] </span><span>
</span><a name="line-71"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Huffman Map in tuple form, example: [([1,0,1], \'c\'), ([1,1,1], \'d\')]</span><span>
</span><a name="line-72"></a><a name="readCodes"><a href="HFIO.html#readCodes"><span class="hs-identifier">readCodes</span></a></a><span> </span><a name="local-6989586621679023580"><a href="#local-6989586621679023580"><span class="hs-identifier">xss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="HFIO.html#readCode"><span class="hs-identifier hs-var">readCode</span></a><span> </span><a href="#local-6989586621679023581"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679023581"><a href="#local-6989586621679023581"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679023580"><span class="hs-identifier hs-var">xss</span></a><span class="hs-special">]</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-identifier">readCode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><a name="readCode"><a href="HFIO.html#readCode"><span class="hs-identifier">readCode</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679023582"><a href="#local-6989586621679023582"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679023583"><a href="#local-6989586621679023583"><span class="hs-identifier">i</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HFIO.html#keyFromString"><span class="hs-identifier hs-var">keyFromString</span></a><span> </span><a href="#local-6989586621679023583"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679023582"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-identifier">readCode</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;readCodes; Bad Huffman codes&quot;</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | Composition of 'readCodes' and 'listifyCodes'</span><span>
</span><a name="line-79"></a><span class="hs-identifier">readCodeString</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>           </span><span class="hs-comment">-- ^ Stringified Huffman map, example: \&quot;c||\@||101\/\/\#\/\/d||\@||110\&quot;</span><span>
</span><a name="line-80"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Huffman Map in tuple form, example: [([1,0,1], \'c\'), ([1,1,1], \'d\')]</span><span>
</span><a name="line-81"></a><a name="readCodeString"><a href="HFIO.html#readCodeString"><span class="hs-identifier">readCodeString</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HFIO.html#readCodes"><span class="hs-identifier hs-var">readCodes</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HFIO.html#listifyCodes"><span class="hs-identifier hs-var">listifyCodes</span></a><span>
</span><a name="line-82"></a></pre></body></html>